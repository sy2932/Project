<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Customer Dashboard - Standard Chartered</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="dashboard.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg fixed-top">
      <div class="container-fluid">
        <a class="navbar-brand" href="index.html">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/0/0c/Standard_Chartered_(2021).svg"
            alt="Logo"
          />
        </a>
        <div class="top-links d-none d-lg-flex">
          <a href="#">Online banking</a>
          <a class="text-white">|</a>
          <a href="#">Private banking online</a>
          <a class="text-white">|</a>
          <a href="#">Straight2Bank</a>
          <a class="text-white">|</a>
          <a href="#">Local sites</a>
          <a class="text-white">|</a>
          <a href="#">Contact us</a>
        </div>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarMain"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarMain">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="bi bi-speedometer2"></i> Dashboards
              </a>
              <ul class="dropdown-menu" id="dashboardDropdownMain">
                <li><h6 class="dropdown-header">Your Accounts</h6></li>
                <li><hr class="dropdown-divider"></li>
                <li id="noDashboardsMain" class="d-none">
                  <a class="dropdown-item text-muted" href="#">
                    <i class="bi bi-info-circle"></i> No accounts created yet
                  </a>
                </li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="bi bi-person-circle"></i>
                <span id="userDisplayName">User</span>
              </a>
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item" href="#" onclick="logout()"
                    ><i class="bi bi-box-arrow-right"></i> Logout</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="main-content">
      <div class="container">
        <div class="dashboard-header">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h1 class="mb-2">Welcome, <span id="customerName"></span>!</h1>
              <p class="mb-0">Manage your account and transactions</p>
            </div>
            <div class="col-md-4 text-end">
                <small>Last login: <span id="lastLogin"></span></small>
            </div>
          </div>
        </div>
      </div>

      <div class="container dashboard-content">
        <div class="row">
          <div class="col-lg-8">
          <div class="balance-card">
            <div class="row">
              <div class="col-md-8">
                <h5>Account Balance</h5>
                <div class="balance-amount">
                  â‚¹<span id="accountBalance">1,00,000</span>
                </div>
                <small
                  >Account Number:
                  <span class="account-number" id="accountNumber"></span
                ></small>
              </div>
              <div class="col-md-4 text-end">
                <i
                  class="bi bi-wallet2"
                  style="font-size: 3rem; opacity: 0.3"
                ></i>
              </div>
            </div>
          </div>

          <div class="quick-actions">
            <a
              href="#"
              class="action-btn send"
              data-bs-toggle="modal"
              data-bs-target="#sendMoneyModal"
            >
              <i class="bi bi-send" style="font-size: 2rem"></i>
              <div class="mt-2">Send Money</div>
            </a>
            <a
              href="#"
              class="action-btn receive"
              data-bs-toggle="modal"
              data-bs-target="#receiveMoneyModal"
            >
              <i class="bi bi-arrow-down-circle" style="font-size: 2rem"></i>
              <div class="mt-2">Receive Money</div>
            </a>
            <a href="customer.html" class="action-btn add-account">
              <i class="bi bi-plus-circle" style="font-size: 2rem"></i>
              <div class="mt-2">Add New Account</div>
            </a>
          </div>

          <div class="card">
            <div
              class="card-header d-flex justify-content-between align-items-center"
            >
              <h5 class="mb-0">Recent Transactions</h5>
              <button
                class="btn btn-outline-primary btn-sm"
                onclick="loadAllTransactions()"
              >
                View All
              </button>
            </div>
            <div class="card-body p-0" id="transactionsList">
            </div>
          </div>

          <div class="card mt-4">
            <div
              class="card-header d-flex justify-content-between align-items-center"
            >
              <h5 class="mb-0">Money Requests</h5>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="loadPendingRequests()"
              >
                Refresh
              </button>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6">
                  <h6 class="text-muted mb-3">Requests You Sent</h6>
                  <div id="sentRequestsList"></div>
                </div>
                <div class="col-md-6">
                  <h6 class="text-muted mb-3">Requests for You</h6>
                  <div id="receivedRequestsList"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="profile-section">
            <h5 class="mb-3" data-bs-toggle="collapse" data-bs-target="#personalInfo" aria-expanded="true" aria-controls="personalInfo" style="cursor: pointer;">
              <i class="bi bi-person-circle"></i> Personal Information
              <i class="bi bi-chevron-down float-end"></i>
            </h5>
            <div class="collapse show" id="personalInfo">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span></span>
                <button class="btn btn-outline-primary btn-sm" onclick="editPersonalInfo()">
                  <i class="bi bi-pencil-square"></i> Edit
                </button>
              </div>
              <div class="profile-item">
                <span><strong>Full Name:</strong></span>
                <span id="profileFullName"></span>
              </div>
              <div class="profile-item">
                <span><strong>Guardian's Name:</strong></span>
                <span id="profileGuardianName"></span>
              </div>
              <div class="profile-item">
                <span><strong>Date of Birth:</strong></span>
                <span id="profileDOB"></span>
              </div>
              <div class="profile-item">
                <span><strong>Gender:</strong></span>
                <span id="profileGender"></span>
              </div>
              <div class="profile-item">
                <span><strong>Marital Status:</strong></span>
                <span id="profileMaritalStatus"></span>
              </div>
              <div class="profile-item">
                <span><strong>Nationality:</strong></span>
                <span id="profileNationality"></span>
              </div>
              <div class="profile-item">
                <span><strong>Occupation:</strong></span>
                <span id="profileOccupation"></span>
              </div>
              <div class="profile-item">
                <span><strong>Residential Status:</strong></span>
                <span id="profileResidentialStatus"></span>
              </div>
            </div>
          </div>

          <div class="profile-section">
            <h5 class="mb-3" data-bs-toggle="collapse" data-bs-target="#contactInfo" aria-expanded="false" aria-controls="contactInfo" style="cursor: pointer;">
              <i class="bi bi-geo-alt-fill"></i> Contact Information
              <i class="bi bi-chevron-down float-end"></i>
            </h5>
            <div class="collapse" id="contactInfo">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span></span>
                <button class="btn btn-outline-primary btn-sm" onclick="editContactInfo()">
                  <i class="bi bi-pencil-square"></i> Edit
                </button>
              </div>
              <div class="profile-item">
                <span><strong>Mobile:</strong></span>
                <span id="profileMobile"></span>
              </div>
              <div class="profile-item">
                <span><strong>Email:</strong></span>
                <span id="profileEmail"></span>
              </div>
              <div class="profile-item">
                <span><strong>Landline:</strong></span>
                <span id="profileLandline"></span>
              </div>
              <div class="profile-item">
                <span><strong>Permanent Address:</strong></span>
                <span id="profilePermanentAddress" class="text-wrap small"></span>
              </div>
              <div class="profile-item">
                <span><strong>Correspondence Address:</strong></span>
                <span
                  id="profileCorrespondenceAddress"
                  class="text-wrap small"
                ></span>
              </div>
            </div>
          </div>

          <div class="profile-section">
            <h5 class="mb-3" data-bs-toggle="collapse" data-bs-target="#kycInfo" aria-expanded="false" aria-controls="kycInfo" style="cursor: pointer;">
              <i class="bi bi-shield-check"></i> KYC Information
              <i class="bi bi-chevron-down float-end"></i>
            </h5>
            <div class="collapse" id="kycInfo">
              <div class="profile-item">
                <span><strong>Aadhaar Number:</strong></span>
                <span id="profileAadhaar" class="account-number"></span>
              </div>
              <div class="profile-item">
                <span><strong>PAN Number:</strong></span>
                <span id="profilePAN" class="account-number"></span>
              </div>
            </div>
          </div>

          <div class="profile-section">
            <h5 class="mb-3" data-bs-toggle="collapse" data-bs-target="#accountInfo" aria-expanded="false" aria-controls="accountInfo" style="cursor: pointer;">
              <i class="bi bi-bank"></i> Account Information
              <i class="bi bi-chevron-down float-end"></i>
            </h5>
            <div class="collapse" id="accountInfo">
              <div class="profile-item">
                <span><strong>Account Type:</strong></span>
                <span id="profileAccountType"></span>
              </div>
              <div class="profile-item">
                <span><strong>Account Number:</strong></span>
                <span class="account-number" id="profileAccountNumber"></span>
              </div>
              <div class="profile-item">
                <span><strong>Initial Deposit:</strong></span>
                <span id="profileInitialDeposit"></span>
              </div>
              <div class="profile-item">
                <span><strong>Member Since:</strong></span>
                <span id="profileMemberSince"></span>
              </div>
            </div>
          </div>

          <div class="profile-section">
            <h5 class="mb-3"><i class="bi bi-graph-up"></i> Quick Stats</h5>
            <div class="profile-item">
              <span>Total Transactions:</span>
              <span id="totalTransactions">0</span>
            </div>
            <div class="profile-item">
              <span>Money Sent:</span>
              <span class="text-danger">â‚¹<span id="totalSent">0</span></span>
            </div>
            <div class="profile-item">
              <span>Money Received:</span>
              <span class="text-success"
                >â‚¹<span id="totalReceived">0</span></span
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="sendMoneyModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title"><i class="bi bi-send"></i> Send Money</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="sendMoneyForm">
              <div class="mb-3">
                <label for="recipientName" class="form-label"
                  >Recipient Name</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="recipientName"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="recipientAccount" class="form-label"
                  >Account Number</label
                >
                <div class="input-group">
                  <input
                    type="text"
                    class="form-control"
                    id="recipientAccount"
                    placeholder="Enter recipient's account number"
                    required
                  />
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    onclick="showAccountLookup('recipient')"
                    title="Lookup account numbers"
                  >
                    <i class="bi bi-search"></i>
                  </button>
                </div>
              </div>
              <div class="mb-3">
                <label for="sendAmount" class="form-label">Amount (â‚¹)</label>
                <input
                  type="number"
                  class="form-control"
                  id="sendAmount"
                  min="1"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="sendRemark" class="form-label"
                  >Remark (Optional)</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="sendRemark"
                  placeholder="Payment for..."
                />
              </div>
              <div class="alert alert-info">
                <small
                  ><i class="bi bi-info-circle"></i> Available Balance: â‚¹<span
                    id="availableBalance"
                  ></span
                ></small>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-success"
              onclick="processSendMoney()"
            >
              <i class="bi bi-send"></i> Send Money
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="receiveMoneyModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <i class="bi bi-arrow-down-circle"></i> Receive Money
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="receiveMoneyForm">
              <div class="mb-3">
                <label for="senderName" class="form-label">Sender Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="senderName"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="senderAccount" class="form-label">Sender Account Number</label>
                <div class="input-group">
                  <input
                    type="text"
                    class="form-control"
                    id="senderAccount"
                    placeholder="Enter sender's account number"
                    required
                  />
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    onclick="showAccountLookup('sender')"
                    title="Lookup account numbers"
                  >
                    <i class="bi bi-search"></i>
                  </button>
                </div>
              </div>
              <div class="mb-3">
                <label for="receiveAmount" class="form-label"
                  >Amount Received (â‚¹)</label
                >
                <input
                  type="number"
                  class="form-control"
                  id="receiveAmount"
                  min="1"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="receiveRemark" class="form-label"
                  >Remark (Optional)</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="receiveRemark"
                  placeholder="Received for..."
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="processReceiveMoney()"
            >
              <i class="bi bi-send"></i> Send Request
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="accountLookupModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <i class="bi bi-list-ul"></i> Registered Account Numbers
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <input
                type="text"
                class="form-control"
                id="accountSearchInput"
                placeholder="Enter account number to search..."
                onkeyup="filterAccounts()"
              />
            </div>
            <div id="accountsList" class="list-group">
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="editPersonalInfoModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <i class="bi bi-person-circle"></i> Edit Personal Information
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="editPersonalForm">
              <div class="row g-3">
                <div class="col-md-6">
                  <label for="editFullName" class="form-label">Full Name</label>
                  <input
                    type="text"
                    class="form-control"
                    id="editFullName"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="editGuardianName" class="form-label">Guardian's Name</label>
                  <input
                    type="text"
                    class="form-control"
                    id="editGuardianName"
                    required
                  />
                </div>
                <div class="col-md-4">
                  <label for="editDOB" class="form-label">Date of Birth</label>
                  <input
                    type="date"
                    class="form-control"
                    id="editDOB"
                    required
                  />
                </div>
                <div class="col-md-4">
                  <label for="editGender" class="form-label">Gender</label>
                  <select class="form-select" id="editGender" required>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label for="editMaritalStatus" class="form-label">Marital Status</label>
                  <select class="form-select" id="editMaritalStatus" required>
                    <option value="Single">Single</option>
                    <option value="Married">Married</option>
                    <option value="Divorced">Divorced</option>
                    <option value="Widowed">Widowed</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label for="editNationality" class="form-label">Nationality</label>
                  <input
                    type="text"
                    class="form-control"
                    id="editNationality"
                    required
                  />
                </div>
                <div class="col-md-4">
                  <label for="editOccupation" class="form-label">Occupation</label>
                  <input
                    type="text"
                    class="form-control"
                    id="editOccupation"
                    required
                  />
                </div>
                <div class="col-md-4">
                  <label for="editResidentialStatus" class="form-label">Residential Status</label>
                  <select class="form-select" id="editResidentialStatus" required>
                    <option value="Resident Indian">Resident Indian</option>
                    <option value="NRI">NRI (Non-Resident Indian)</option>
                    <option value="Foreign National">Foreign National</option>
                  </select>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="savePersonalInfo()"
            >
              <i class="bi bi-check-circle"></i> Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="editContactInfoModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <i class="bi bi-geo-alt-fill"></i> Edit Contact Information
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="editContactForm">
              <div class="row g-3">
                <div class="col-md-4">
                  <label for="editMobile" class="form-label">Mobile Number</label>
                  <input
                    type="tel"
                    class="form-control"
                    id="editMobile"
                    pattern="[0-9]{10}"
                    required
                  />
                </div>
                <div class="col-md-4">
                  <label for="editEmail" class="form-label">Email Address</label>
                  <input
                    type="email"
                    class="form-control"
                    id="editEmail"
                    required
                  />
                </div>
                <div class="col-md-4">
                  <label for="editLandline" class="form-label">Landline</label>
                  <input
                    type="tel"
                    class="form-control"
                    id="editLandline"
                  />
                </div>
                <div class="col-md-6">
                  <label for="editPermanentAddress" class="form-label">Permanent Address</label>
                  <textarea
                    class="form-control"
                    id="editPermanentAddress"
                    rows="3"
                    required
                  ></textarea>
                </div>
                <div class="col-md-6">
                  <label for="editCorrespondenceAddress" class="form-label">Correspondence Address</label>
                  <textarea
                    class="form-control"
                    id="editCorrespondenceAddress"
                    rows="3"
                  ></textarea>
                  <div class="form-check mt-2">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="editSameAsPermananent"
                    />
                    <label class="form-check-label" for="editSameAsPermananent">
                      Same as permanent address
                    </label>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="saveContactInfo()"
            >
              <i class="bi bi-check-circle"></i> Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="auth-utils.js"></script>
    <script src="dashboard.js"></script>
  </body>
</html>
